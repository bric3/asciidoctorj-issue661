buildscript {
    repositories { jcenter() }
    dependencies {
        classpath 'org.asciidoctor:asciidoctor-gradle-plugin:1.5.7'
        classpath 'org.asciidoctor:asciidoctorj-diagram:1.5.9' // broken
//        classpath 'org.asciidoctor:asciidoctorj-diagram:1.5.8' // works
    }
}

ext {
    springRestDocs = '1.2.4.RELEASE'
}

apply plugin: 'org.asciidoctor.convert'


dependencies {
    asciidoctor "org.springframework.restdocs:spring-restdocs-asciidoctor:$springRestDocs"
}

ext {
    snippetsDir = file("src/main/snippets")
}

asciidoctorj {
    version = "1.5.7"
}

asciidoctor {
    requires 'asciidoctor-diagram'
    options doctype: 'book'
    attributes = [
            'snippets'          : snippetsDir,
            'source-highlighter': 'coderay',
            'encoding'          : 'utf-8',
            'version'           : project.version
    ]
    sources {
        include 'main.adoc'
    }
}
